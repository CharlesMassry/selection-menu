{"name":"JavaScript context menu on selection","tagline":"Automatically pop over a context menu when the user selects text","body":"# SelectionMenu\r\n\r\nSelectionMenu is a small, self-contained, framework-agnostic JavaScript module that displays a custom context menu when the user selects text text on the page.\r\n\r\nThis menu may offer a search feature, dictionary lookup, post to Facebook or similar.\r\n\r\n\r\n## History\r\n\r\nThe motivation for creating this module was having a sleek contextual selection mechanism in the Chrome extension for [iDoRecall](http://idorecall.com). \r\n\r\nThis module is largely my fork of [Mathias Sch√§fer](https://github.com.molily)'s work from 2011, brought up to date with modern browsers (Chrome, Firefox, Safari, Opera, IE9+) and the AMD module pattern. [Xavier Damman](https://github.com/xdamman/)'s [selection-sharer](https://github.com/xdamman/selection-sharer) was another influence (detecting the forward vs. backward selection direction).\r\n\r\nThe idea and the implementation originally resemble the selection context menu on nytimes.com, but the script is way simpler and easier to integrate. \r\n\r\nThe script uses the [W3C DOM Range](http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html), which is available in modern browsers: IE9+, Chrome, Firefox, Safari, Opera.\r\n\r\n\r\n## Features and differences from the original\r\n\r\n* Display the context menu near where the mouse button was released (the original always displayed the menu at the end of the selection, and selection-sharer displays it [asymmetrically](https://github.com/xdamman/selection-sharer/issues/18)) and [always at the top of the selection](https://github.com/xdamman/selection-sharer/issues/17)\r\n* Pass any HTML for the context menu, and style it as you want via its id\r\n* Keyboard events are not handled, so that if the user wants to make fine adjustments to the selection with Shift+arrows, the menu will remain near the mouse cursor\r\n* The menu text is made unselectable (fixes a number of [bugs in the original library](https://github.com/molily/selectionmenu/issues/5))\r\n* Supports minimum and maximum selection length ([selection-sharer #10](https://github.com/xdamman/selection-sharer/issues/13))\r\n* Clicking outside the popover *always* closes the menu (fixes [selection-sharer #11](https://github.com/xdamman/selection-sharer/issues/11))\r\n* `onselect` event\r\n* Dynamic menu depending on the content of the selection\r\n\r\n\r\n## Usage\r\n\r\nCreate an instance of SelectionMenu by calling `new SelectionMenu`.\r\n\r\nPass an object literal with the following options:\r\n\r\n* `container` (DOM element): The element where the copy event is observed. Normally that's the main text container.\r\n* `menuHTML` (string): A string of HTML for the menu e.g. a list of links.\r\n* `handler` (function): A handler function which is called when the user clicks on the menu. Use the passed click event to access the click link and respond to the user's action.\r\n* `minlength` (number, optional): Only display the menu if the selected text has at least this length. Defaults to 5 characters.\r\n* `maxlength` (number, optional): Only display the menu if the selected text is at most this long. Defaults to `Infinity`.\r\n* `id` (string, optional): The ID of the menu element which is inserted. Defaults to `selection-menu`.\r\n* `onselect` (function, optional): Custom event generated when the mouse selection changes. Not generated when the selection is changed via the keyboard. Use it to customize the menu dynamically based on the contents of the selection:\r\n\r\n    ```js\r\n    new SelectionMenu({\r\n      ...\r\n      onselect: function (e) {\r\n        this.menuHTML = 'Selection length: ' + this.selectedText.length;\r\n      }\r\n    });\r\n    ```\r\n\r\n\r\n## Example\r\n\r\nThis observes mouseup events on the element with the ID `article`. It inserts a menu\r\nwith two links which both have IDs to recognize them. In the handler function, the\r\nselected text is read. Depending on the clicked link, the selected text is\r\nlooked up on Google or Bing.\r\n\r\n```js\r\nnew SelectionMenu({\r\n  container: document.getElementById('article'),\r\n  menuHTML: '<a id=\"selection-menu-google\">Google Search</a><a id=\"selection-menu-bing\">Bing Search</a>',\r\n  handler: function (e) {\r\n    var target = e.target,\r\n      id = target.id,\r\n      selectedText = this.selectedText,\r\n      query = encodeURI(selectedText.replace(/\\s/g, '+')),\r\n      searchURI;\r\n    \r\n    if (id === 'selection-menu-google') {\r\n      searchURI = 'http://www.google.com/search?ie=utf-8&q=';\r\n    } else if (id === 'selection-menu-bing') {\r\n      searchURI = 'http://www.bing.com/search?q=';\r\n    }\r\n    \r\n    location.href = searchURI + query;\r\n  }\r\n});\r\n```\r\n\r\nTo define menus more flexibly, use a hidden `<div>` in your HTML, and pass its `innerHTML` to SelectionMenu:\r\n\r\n```html\r\n<div id=\"mymenu\" hidden>\r\n  <ul>\r\n    <li>Option one\r\n    <li>Option two\r\n  </ul>  \r\n</div>\r\n```\r\n\r\n```js\r\nnew SelectionMenu({\r\n  container: document.getElementById('article'),\r\n  menuHTML: document.getElementById('mymenu').innerHTML,\r\n  handler: function (e) {\r\n    ...\r\n  }\r\n});\r\n```\r\n\r\n## Upcoming features\r\n\r\n* automatically position menu to preserve width if created near the right border of the container, and not go off screen if the selection is made near the very top\r\n\r\n\r\n## License and copyright\r\n\r\nMaintainer: Dan Dascalescu ([@dandv](https://github.com/dandv))\r\n\r\nCopyright (C) 2015 [iDoRecall](http://idorecall.com), Inc.\r\n\r\nThe MIT License (MIT)\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}